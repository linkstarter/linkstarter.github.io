# 微服务（一）-概览
2021年12月14日
> 本系列文章，按照毛剑老师的《Go进阶训练营》视频+【mohuishou】大佬的博客共同组织编辑，可能会有很多地方跟大佬博客高度重合，但确实会有自己的思考。

看完视频概览以后，带着问题总结一下。

1.  什么是微服务？
2.  为什么需要微服务？
3.  微服务的优缺点？
4.  如何拆分微服务？
5.  引入了哪些新的概念？

## Q1:什么是微服务
-   微服务的定义
    -   围绕业务功能构建的，服务关注单一业务，服务间采用轻量级的通信机制，可以全自动独立部署，可以使用不同的编程语言和数据存储技术。
-   微服务的特性
    -   原子服务。服务的职责单一，职责清晰，只做一件事情（比如只提供点赞功能）
    -   独立进程。一个服务一个进程，结合容器化部署，弹性伸缩以及更新都比较容易。
    -   隔离部署。每个服务相互隔离，避免相互影响，比如通过docker部署，每个服务都有自己独立的文件系统。
    -   去中心化服务治理。
        -   数据去中心化。每个服务单独占用数据库，也有多个服务共享数据库的情况。比如用户管理后台与管理员后台，没必要搞两套用户数据库。
        -   治理去中心化
        -   技术去中心化。每个服务可以用不同的技术栈，只要约定好通信方式就行。但是一般情况最好不要使用过多的技术栈，尽量收敛。

-   SOA（面向服务的架构模式）
    -   可以说，微服务是SOA的一种实践
    -   小即是美。小的服务代码少，bug少，容易测试，容易维护，容易迭代。
    -   单一职责。职责单一，研发能够完全搞懂一个微服务。
    -   尽可能早地创建原型。能够尽可能早的提供服务API，达成服务间一致性约定。
    -   可以执行比效率更重要。
## Q2:为什么需要微服务
-   单体（巨石）架构的缺点
    -   应用复杂，单个研发无法完全掌握
    -   扩展性差、可靠性低
    -   无法完成敏捷性开发和部署

-   所以一般按照服务、功能进行拆分

## Q3:微服务的优缺点
-   优点
    -   其实在上面微服务定义中已经说了。
-   缺点
    -   微服务采用分布式架构，无可避免的带来固有的复杂性。不得不使用RPC或者其他方式实现进程间通信；需要考虑服务间调用过慢或者服务不可用的情况。
    -   分区的数据库架构，导致同一个业务场景下，需要多个服务更新多个数据库，事务或者说数据一致性问题更加难以处理。
    -   测试基于微服务架构的应用（不是单个微服务），也是很复杂的任务。
    -   服务模块间的依赖，应用的升级可能会波及多个服务的修改。
    -   对运维基础设施的挑战比较大。
## Q4:如何拆分微服务
-   业务职能
    -   根据部门不同，拆分成不同的服务。
-   DDD
    -   通过解决某类业务而划分服务。